(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6633],{9376:(e,s,a)=>{Promise.resolve().then(a.bind(a,2351))},929:(e,s,a)=>{"use strict";a.d(s,{A:()=>n});var t=a(5155);a(2115),a(4892);let n=()=>(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{className:"loading-overlay",children:[(0,t.jsx)("div",{className:"loading-spinner"}),(0,t.jsx)("p",{children:"Loading..."})]})})},4194:(e,s,a)=>{"use strict";a.d(s,{db:()=>l,j2:()=>i});var t=a(9904),n=a(7058),o=a(4565);let r=(0,t.Wp)({apiKey:"AIzaSyBJ_h8hsYSrF6n_aUHNcSM9Sxarjy9vdis",authDomain:"homelibrary-3eb02.firebaseapp.com",projectId:"homelibrary-3eb02",storageBucket:"homelibrary-3eb02.appspot.com",messagingSenderId:"193740511363",appId:"1:193740511363:web:1aa41e575c0e79ae3be3b6"}),i=(0,o.xI)(r),l=(0,n.aU)(r)},2351:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>d});var t=a(5155),n=a(2115);a(1674);var o=a(3189),r=a(151),i=a(4194),l=a(7058),c=a(8199);let d=()=>{let[e,s]=(0,n.useState)([]),[a,d]=(0,n.useState)({});(0,n.useEffect)(()=>{(async()=>{try{console.log("Fetching books awaiting moderation...");let e=(0,l.rJ)(i.db,"books"),a=(0,l.P)(e,(0,l._M)("moderationStatus","==","pending")),t=(await (0,l.GG)(a)).docs.map(e=>{var s,a;return{id:e.id,title:e.data().book,author:e.data().author,price:"Rs.".concat(e.data().price,".00"),sellerUid:e.data().uid||"unknown",bid:e.data().bid,createdAt:(null===(s=e.data().createdAt)||void 0===s?void 0:s.toDate())||new Date,imageUrl:(null===(a=e.data().uploadedImages)||void 0===a?void 0:a[0])||"/placeholder.png",moderationStatus:e.data().moderationStatus||"pending"}});s(t),console.log("Fetched pending books:",t);let n=[...new Set(t.map(e=>e.sellerUid).filter(e=>"unknown"!==e))];if(0===n.length)return;let o={};await Promise.all(n.map(async e=>{try{console.log("Fetching seller for UID: ".concat(e));let s=(0,l.H9)(i.db,"users",e),a=await (0,l.x7)(s);if(a.exists()){let s=a.data();o[e]="".concat(s.fname," ").concat(s.lname),console.log("Seller found: ".concat(o[e]))}else o[e]="Unknown Seller"}catch(s){console.error("Error fetching user ".concat(e,":"),s),o[e]="Unknown Seller"}})),d(o),console.log("Final Seller Names Updated:",o)}catch(e){console.error("Error fetching books:",e)}})()},[]);let u=async(e,a)=>{try{console.log("Updating book ID ".concat(e," status to: ").concat(a));let t=(0,l.H9)(i.db,"books",e);await (0,l.mZ)(t,{moderationStatus:a}),s(s=>s.filter(s=>s.id!==e)),alert("Book ".concat(a))}catch(e){console.error("Error updating book status: ".concat(e))}};return(0,t.jsxs)("div",{children:[(0,t.jsx)(o.A,{}),(0,t.jsxs)("div",{className:"maincontainer",children:[(0,t.jsx)(r.A,{}),(0,t.jsx)("div",{className:"tempcontainer",children:e.length>0?e.map(e=>(0,t.jsx)(c.A,{imageUrl:e.imageUrl,title:e.title,author:e.author,price:e.price,sellerName:a[e.sellerUid]||"Loading...",sellerUid:e.sellerUid,bid:e.bid,onApprove:()=>u(e.id,"approved"),onReject:()=>u(e.id,"rejected")},e.id)):(0,t.jsx)("p",{children:"No books available."})})]})]})}},8199:(e,s,a)=>{"use strict";a.d(s,{A:()=>n});var t=a(5155);a(2115),a(2116);let n=e=>{let{imageUrl:s,title:a,author:n,price:o,sellerName:r,onApprove:i,onReject:l,sellerUid:c,bid:d}=e;return(0,t.jsxs)("div",{className:"allcontainer",children:[(0,t.jsx)("img",{src:s,alt:a}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{children:a}),(0,t.jsxs)("h3",{children:["Author: ",n]}),(0,t.jsx)("p",{children:o}),(0,t.jsxs)("button",{className:"sellerbutton",onClick:()=>window.open("/pages/seller/".concat(c,"/SellerPage"),"_blank"),children:["Seller: ",r]}),(0,t.jsx)("br",{}),(0,t.jsx)("button",{className:"checkbutton",onClick:()=>window.open("/pages/".concat(d,"/ProductPage"),"_self"),children:"Check Listing"})]}),(0,t.jsx)("div",{className:"buttons",children:(0,t.jsxs)("div",{className:"approvebuttons",children:[(0,t.jsx)("button",{className:"right",onClick:i,children:"✓"}),(0,t.jsx)("button",{className:"wrong",onClick:l,children:"✘"})]})})]})}},151:(e,s,a)=>{"use strict";a.d(s,{A:()=>i});var t=a(5155),n=a(2115);a(752);var o=a(929),r=a(6046);let i=()=>{let[e,s]=(0,n.useState)(!1),a=(0,r.useRouter)(),[i,l]=(0,n.useState)("");(0,n.useEffect)(()=>{let e=sessionStorage.getItem("adminid");e?l(e):a.push("/LoginPages/adminlogin")},[]);let c=e=>{i&&(s(!0),setTimeout(()=>{a.push("/pages/Moderation/".concat(i,"/").concat(e)),s(!1)},1500))};return(0,t.jsxs)(t.Fragment,{children:[e&&(0,t.jsx)(o.A,{}),(0,t.jsxs)("div",{className:"sidemenucontainer",children:[(0,t.jsxs)("button",{onClick:()=>c("NewListings"),children:[(0,t.jsx)("img",{src:"/dashhome.svg",alt:"Dashboard Icon"})," New Listings"]}),(0,t.jsxs)("button",{onClick:()=>c("AllListings"),children:[(0,t.jsx)("img",{src:"/dashadd.svg",alt:"Add Book Icon"})," All Listings"]}),(0,t.jsxs)("button",{onClick:()=>c("AllUsers"),children:[(0,t.jsx)("img",{src:"/dashview.svg",alt:"View Books Icon"})," View Users"]}),(0,t.jsxs)("button",{onClick:()=>c("AddModerator"),children:[(0,t.jsx)("img",{src:"/dashbuy.svg",alt:"Settings"})," Add Moderator"]}),(0,t.jsxs)("button",{onClick:()=>{sessionStorage.removeItem("adminid"),a.push("/pages/LoginPages/adminlogin")},children:[(0,t.jsx)("img",{src:"/dashout.svg",alt:"Logout Icon"})," Log Out"]})]})]})}},3189:(e,s,a)=>{"use strict";a.d(s,{A:()=>l});var t=a(5155),n=a(2115);a(662);var o=a(4194),r=a(7058),i=a(4565);let l=()=>{let[e,s]=(0,n.useState)(null);return(0,n.useEffect)(()=>{let e=(0,i.hg)(o.j2,async e=>{if(e&&e.email){let a=(0,r.rJ)(o.db,"admins"),t=(0,r.P)(a,(0,r._M)("email","==",e.email)),n=await (0,r.GG)(t);n.empty||s(n.docs[0].data())}});return()=>e()},[]),(0,t.jsxs)("div",{className:"topmenucontainer",children:[(0,t.jsx)("img",{src:"/logo.png",className:"logotop",alt:"logo"}),(0,t.jsxs)("div",{className:"namecontainer",children:[(0,t.jsx)("div",{className:"profilePicture",children:(0,t.jsx)("img",{src:"/pp.jpg",alt:"profile"})}),(0,t.jsxs)("div",{className:"topmenunames",children:[(0,t.jsx)("h1",{children:(null==e?void 0:e.fullname)||"Loading..."}),(0,t.jsx)("p",{children:(null==e?void 0:e.role)||""})]})]})]})}},6046:(e,s,a)=>{"use strict";var t=a(6658);a.o(t,"useParams")&&a.d(s,{useParams:function(){return t.useParams}}),a.o(t,"useRouter")&&a.d(s,{useRouter:function(){return t.useRouter}}),a.o(t,"useSearchParams")&&a.d(s,{useSearchParams:function(){return t.useSearchParams}})},4892:()=>{},1674:()=>{},2116:()=>{},752:()=>{},662:()=>{}},e=>{var s=s=>e(e.s=s);e.O(0,[7051,5951,4725,2029,9895,2992,7512,4778,8441,1517,7358],()=>s(9376)),_N_E=e.O()}]);