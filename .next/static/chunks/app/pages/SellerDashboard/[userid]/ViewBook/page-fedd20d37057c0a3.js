(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[799],{7398:(e,a,t)=>{Promise.resolve().then(t.bind(t,99))},6098:(e,a,t)=>{"use strict";t.d(a,{Ve:()=>o,zi:()=>n}),t(5155),t(7690);let o="https://api.cloudinary.com/v1_1/dipztwslj/upload",n="bookimages"},4194:(e,a,t)=>{"use strict";t.d(a,{db:()=>r,j2:()=>l});var o=t(9904),n=t(7058),s=t(4565);let i=(0,o.Wp)({apiKey:"AIzaSyBJ_h8hsYSrF6n_aUHNcSM9Sxarjy9vdis",authDomain:"homelibrary-3eb02.firebaseapp.com",projectId:"homelibrary-3eb02",storageBucket:"homelibrary-3eb02.firebasestorage.app",messagingSenderId:"193740511363",appId:"1:193740511363:web:1aa41e575c0e79ae3be3b6"}),l=(0,s.xI)(i),r=(0,n.aU)(i)},99:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>c});var o=t(5155),n=t(2115);t(3237),t(5217);var s=t(7058),i=t(4194),l=t(6098);let r=e=>{let[a,t]=(0,n.useState)(!1),[r,d]=(0,n.useState)(!1),[c,u]=(0,n.useState)([]),[p,h]=(0,n.useState)({book:e.bookname,publisher:e.authorname,price:e.bookprice,condition:e.bookdes,tags:[e.tag1,e.tag2,e.tag3,e.tag4,e.tag5],location:"",description:"",pagescount:"",binding:"",category:"",isbnnumber:"",publishedate:""}),g=(0,n.useRef)(null),[b,m]=(0,n.useState)(e.bookname),k=(e,a)=>{let{name:t,value:o}=e.target;if("tags"===t&&"number"==typeof a){let e=[...p.tags];e[a]=o,h({...p,tags:e})}else h({...p,[t]:o})},v=async()=>{if(window.confirm("Are you sure you want to delete this book? This action cannot be undone."))try{let a=(0,s.H9)(i.db,"books",e.id);await (0,s.kd)(a),alert("Book deleted successfully.")}catch(e){console.error("Error deleting book:",e),alert("Failed to delete book.")}},x=async()=>{if(window.confirm("Are you sure you want to mark this book as SOLD?"))try{let a=(0,s.H9)(i.db,"books",e.id);await (0,s.mZ)(a,{moderationStatus:"sold"}),alert("Book marked as SOLD.")}catch(e){console.error("Error updating status:",e),alert("Failed to update status.")}},j=async e=>{let a=new FormData;a.append("file",e),a.append("upload_preset",l.zi);let t=await fetch(l.Ve,{method:"POST",body:a});return(await t.json()).secure_url},y=async()=>{d(!0);try{let a=[];if(c.length>0){let e=c.map(e=>j(e));a=await Promise.all(e)}let o=(0,s.H9)(i.db,"books",e.id);await (0,s.mZ)(o,{...p,uploadedImages:a.length>0?a:void 0}),alert("Book updated successfully!"),t(!1)}catch(e){console.error("Error updating book:",e),alert("Update failed")}finally{d(!1)}};return(0,n.useEffect)(()=>{let a=g.current;if(!a)return;let t=()=>{let t=e.bookname;for(a.textContent=t;a.scrollWidth>a.clientWidth&&t.length>0;)t=t.slice(0,-1),a.textContent=t+"...";m(a.textContent||e.bookname)};return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[e.bookname]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{className:"viewbookcontainer",children:[(0,o.jsx)("div",{className:"imagecontainer",children:(0,o.jsx)("img",{src:e.productimage})}),(0,o.jsxs)("div",{className:"textcontainer",children:[(0,o.jsxs)("p",{className:"bookname",children:[e.bookname.split(" ").slice(0,3).join(" "),e.bookname.split(" ").length>4&&"..."]}),(0,o.jsxs)("p",{className:"authorname",children:["by ",e.authorname]}),(0,o.jsxs)("p",{className:"bookprice",children:["Price: Rs.",e.bookprice]}),(0,o.jsx)("p",{className:"bookdes",children:e.bookdes}),(0,o.jsxs)("p",{className:"tags",children:["Tag:",[e.tag1,e.tag2,e.tag3,e.tag4,e.tag5].map((e,a)=>e&&(0,o.jsx)("p",{className:"taggs",children:e},a))]})]}),(0,o.jsxs)("div",{className:"viewbuttons",children:[(0,o.jsx)("button",{onClick:()=>t(!0),children:"EDIT BOOK"}),(0,o.jsx)("button",{onClick:x,children:"MARK AS SOLD"}),(0,o.jsx)("button",{className:"delbutton",onClick:v,children:"DELETE BOOK"})]})]}),a&&(0,o.jsx)("div",{className:"modal-overlay",children:(0,o.jsxs)("div",{className:"modal",children:[(0,o.jsx)("h2",{children:"Edit Book"}),(0,o.jsx)("input",{name:"book",value:p.book,onChange:k,placeholder:"Book Name"}),(0,o.jsx)("input",{name:"publisher",value:p.publisher,onChange:k,placeholder:"Author"}),(0,o.jsx)("input",{name:"price",value:p.price,onChange:k,placeholder:"Price"}),(0,o.jsx)("textarea",{name:"condition",value:p.condition,onChange:k,placeholder:"Condition"}),(0,o.jsx)("textarea",{name:"description",value:p.description,onChange:k,placeholder:"Description"}),(0,o.jsx)("input",{name:"location",value:p.location,onChange:k,placeholder:"Location"}),(0,o.jsx)("input",{name:"pagescount",value:p.pagescount,onChange:k,placeholder:"Pages"}),(0,o.jsx)("input",{name:"binding",value:p.binding,onChange:k,placeholder:"Binding Type"}),(0,o.jsx)("input",{name:"category",value:p.category,onChange:k,placeholder:"Category"}),(0,o.jsx)("input",{name:"isbnnumber",value:p.isbnnumber,onChange:k,placeholder:"ISBN"}),(0,o.jsx)("input",{name:"publishedate",value:p.publishedate,onChange:k,placeholder:"Publish Date"}),p.tags.map((e,a)=>(0,o.jsx)("input",{name:"tags",value:e,onChange:e=>k(e,a),placeholder:"Tag ".concat(a+1)},a)),(0,o.jsx)("label",{children:"Upload up to 7 images:"}),(0,o.jsx)("input",{type:"file",multiple:!0,accept:"image/*",onChange:e=>{e.target.files&&u(Array.from(e.target.files).slice(0,7))}}),(0,o.jsxs)("div",{className:"modal-buttons",children:[(0,o.jsx)("button",{onClick:y,disabled:r,children:r?"Updating...":"Save Changes"}),(0,o.jsx)("button",{onClick:()=>t(!1),children:"Cancel"})]})]})})]})};var d=t(4565);let c=()=>{let[e,a]=(0,n.useState)([]),[t,l]=(0,n.useState)(!0),[c,u]=(0,n.useState)(null);(0,n.useEffect)(()=>{let e=(0,d.hg)(i.j2,e=>{e?(u(e.uid),p(e.uid)):(u(null),a([]))});return()=>e()},[]);let p=async e=>{try{let t=(0,s.rJ)(i.db,"books"),o=(0,s.P)(t,(0,s._M)("uid","==",e)),n=(await (0,s.GG)(o)).docs.map(e=>({id:e.id,...e.data()}));a(n)}catch(e){console.error("Error fetching user books:",e)}finally{l(!1)}};return(0,o.jsx)("div",{className:"belowdash",children:(0,o.jsx)("div",{className:"tempconta",children:t?(0,o.jsx)("p",{children:"Loading books..."}):e.length>0?e.map(e=>{var a,t,n,s,i,l;return(0,o.jsx)(r,{id:e.id,productimage:(null===(a=e.uploadedImages)||void 0===a?void 0:a[0])||"/product.png",bookname:e.book,authorname:e.publisher,bookprice:e.price,bookdes:e.condition,tag1:(null===(t=e.tags)||void 0===t?void 0:t[0])||"",tag2:(null===(n=e.tags)||void 0===n?void 0:n[1])||"",tag3:(null===(s=e.tags)||void 0===s?void 0:s[2])||"",tag4:(null===(i=e.tags)||void 0===i?void 0:i[3])||"",tag5:(null===(l=e.tags)||void 0===l?void 0:l[4])||""},e.id)}):(0,o.jsx)("p",{children:"No books found."})})})}},3237:()=>{},5217:()=>{}},e=>{var a=a=>e(e.s=a);e.O(0,[9779,9895,2992,7512,4778,7970,7690,8441,1517,7358],()=>a(7398)),_N_E=e.O()}]);